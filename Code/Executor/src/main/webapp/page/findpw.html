<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <title>找回密码 | Q-Executor</title>
    <link rel="icon" href="../images/icon.ico">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
</head>
<body>
<div class="container">

	<div class="row top-padding bottom-padding">
		<ul id="nav" class="nav nav-tabs center-block">
			<li class="active"><a href="#confirm" data-toggle="tab">确认账号</a></li>
			<li><a href="#reset" data-toggle="tab">重置密码</a></li>
		</ul>
	</div>

	<div class="tab-content">
		<div class="tab-pane fade in active" id="confirm">
			<div class="row top-padding bottom-padding">
				<div class="col-xs-8 col-sm-6 col-md-4 col-lg-4">
					<input type="email" class="form-control" placeholder="邮箱">
				</div>
			</div>
			<div class="row top-padding bottom-padding">
				<div class="col-xs-8 col-sm-6 col-md-4 col-lg-4">
					<button class="btn btn-primary btn-block">发送重置密码邮件</button>
				</div>	
			</div>
		</div>

		<div class="tab-pane fade" id="reset">
			<div class="row top-padding bottom-padding">
				<div class="col-xs-8 col-sm-6 col-md-4 col-lg-4">
					<input type="password" class="form-control" placeholder="请输入新密码">
				</div>
			</div>
			<div class="row top-padding bottom-padding">
				<div class="col-xs-8 col-sm-6 col-md-4 col-lg-4">
					<input type="password" class="form-control" placeholder="新密码确认">
				</div>
			</div>
			<div class="row top-padding bottom-padding">
				<div class="col-xs-8 col-sm-6 col-md-4 col-lg-4">
					<button class="btn btn-primary btn-block">确定</button>
				</div>	
			</div>
		</div>
	</div>
</div>


<script src="../js/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/check.js"></script>
<script type="text/javascript">
    $('#send-mail').on('click', function () {
        if ($('#mail').val().trim() != '') {
            // TODO 接口不一致
            jQuery.ajax({
                url: '/findPassword',
                type: 'post',
                dataType: 'json',
                data: 'userName=' + $('#mail').val().trim(),
                success: function (data) {
                    if (data.state == true) {
                        $('#nav a[href="#verify"]').attr('data-toggle', 'tab').tab('show');
                    } else {
                        alert(data.info);
                    }
                }
            });
        }
    });

    $('#confirm-identify').on('click', function () {
        if ($('#identify').val().trim() != '') {
            jQuery.ajax({
                url: '/',
                type: 'post',
                dataType: 'json',
                data: 'identify=' + $('#identify').val().trim(),
                success: function (data) {
                    if (data.state) {
                        $('#nav a[href="#reset"]').attr('data-toggle', 'tab').tab('show');
                    } else {
                        alert(data.info);
                    }
                }
            });
        }
    });

    $('#reset-password').on('click', function () {
        if ($('#password').val().trim() != ''
                && $('#confirmPassword').val().trim() != ''
                && $('#password').val().trim() == $('#confirmPassword').val().trim()) {
            jQuery.ajax({
                url: '/',
                type: 'post',
                dataType: 'json',
                data: 'password=' + $('#password').val().trim(),
                success: function(data) {
                    // TODO 接口和实现不一致
                }
            });
        }
    })
</script>
</body>
</html>